diff -ur pidentd-3.1a14.orig/src/k_linux.c pidentd-3.1a14/src/k_linux.c
--- pidentd-3.1a14.orig/src/k_linux.c	Fri Jun  2 21:15:38 2000
+++ pidentd-3.1a14/src/k_linux.c	Fri Jun  2 21:22:18 2000
@@ -60,13 +60,13 @@
     while ((fp[FP_INET6] = fopen("/proc/net/tcp6", "r")) == NULL &&
 	   errno == EINTR)
 	;
-    
+#if 0 
     if (fp[FP_INET6] == NULL)
     {
 	syslog(LOG_ERR, "fopen(\"/proc/net/tcp6\", \"r\"): %m");
 	return -1;
     }
-
+#endif
     while ((fp[FP_INET] = fopen("/proc/net/tcp", "r")) == NULL &&
 	   errno == EINTR)
 	;
@@ -174,6 +174,8 @@
     r_laddr = &kp->local.su_sin6_addr;
 
     fp = ((FILE **)vp)[FP_INET6];
+    if (fp == NULL)
+	    return -1;
 
     kp->ruid = NO_UID;
 
Only in pidentd-3.1a14/src: k_linux.c~
